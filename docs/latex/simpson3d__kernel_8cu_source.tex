\doxysection{simpson3d\+\_\+kernel.\+cu}
\hypertarget{simpson3d__kernel_8cu_source}{}\label{simpson3d__kernel_8cu_source}\index{src/utils/simpson3d\_kernel.cu@{src/utils/simpson3d\_kernel.cu}}
\mbox{\hyperlink{simpson3d__kernel_8cu}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{simpson3d__kernel_8cu_source_l00001}00001\ }
\DoxyCodeLine{\Hypertarget{simpson3d__kernel_8cu_source_l00009}00009\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{simpson3d__kernel_8cuh}{simpson3d\_kernel.cuh}}"{}}}
\DoxyCodeLine{\Hypertarget{simpson3d__kernel_8cu_source_l00010}00010\ \textcolor{preprocessor}{\#include\ <cuda\_runtime.h>}}
\DoxyCodeLine{\Hypertarget{simpson3d__kernel_8cu_source_l00011}00011\ \textcolor{preprocessor}{\#include\ <cstdio>}}
\DoxyCodeLine{\Hypertarget{simpson3d__kernel_8cu_source_l00012}00012\ }
\DoxyCodeLine{\Hypertarget{simpson3d__kernel_8cu_source_l00023}\mbox{\hyperlink{simpson3d__kernel_8cu_abb2d4be601f829710933376c26dbfc92}{00023}}\ \mbox{\hyperlink{imag3d-cuda_8cu_afaf6dab3e9b4810733c8338a9e9c8e7c}{\_\_global\_\_}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{simpson3d__kernel_8cu_abb2d4be601f829710933376c26dbfc92}{simpson3d\_tiled\_reduce}}(\textcolor{keywordtype}{double}\ *\mbox{\hyperlink{imag3d-cuda_8cu_afaf6dab3e9b4810733c8338a9e9c8e7c}{f}},\ \textcolor{keywordtype}{double}\ *\mbox{\hyperlink{imag3d-cuda_8cu_afaf6dab3e9b4810733c8338a9e9c8e7c}{partial\_sums}},\ }
\DoxyCodeLine{\Hypertarget{simpson3d__kernel_8cu_source_l00024}00024\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{long}\ \mbox{\hyperlink{imag3d-cuda_8cuh_a97700218037a126a9957568d3fe1a8a9}{Nx}},\ \textcolor{keywordtype}{long}\ \mbox{\hyperlink{imag3d-cuda_8cuh_a8202396220c6bb040150929886702185}{Ny}},\ \textcolor{keywordtype}{long}\ \mbox{\hyperlink{imag3d-cuda_8cuh_a51376252920a483727821c5db4ee36ff}{Nz}},}
\DoxyCodeLine{\Hypertarget{simpson3d__kernel_8cu_source_l00025}00025\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{long}\ tile\_size\_z,\ \textcolor{keywordtype}{long}\ \mbox{\hyperlink{imag3d-cuda_8cu_afaf6dab3e9b4810733c8338a9e9c8e7c}{z\_start}})\ \{}
\DoxyCodeLine{\Hypertarget{simpson3d__kernel_8cu_source_l00026}00026\ \ \ \textcolor{keyword}{extern}\ \mbox{\hyperlink{imag3d-cuda_8cu_afaf6dab3e9b4810733c8338a9e9c8e7c}{\_\_shared\_\_}}\ \textcolor{keywordtype}{double}\ \mbox{\hyperlink{imag3d-cuda_8cu_afaf6dab3e9b4810733c8338a9e9c8e7c}{sdata}}[];}
\DoxyCodeLine{\Hypertarget{simpson3d__kernel_8cu_source_l00027}00027\ \ \ }
\DoxyCodeLine{\Hypertarget{simpson3d__kernel_8cu_source_l00028}00028\ \ \ \textcolor{comment}{//\ Calculate\ thread\ ID\ within\ block}}
\DoxyCodeLine{\Hypertarget{simpson3d__kernel_8cu_source_l00029}00029\ \ \ \textcolor{keywordtype}{long}\ \mbox{\hyperlink{imag3d-cuda_8cu_afaf6dab3e9b4810733c8338a9e9c8e7c}{tid}}\ =\ \mbox{\hyperlink{imag3d-cuda_8cu_afaf6dab3e9b4810733c8338a9e9c8e7c}{threadIdx}}.x\ +\ \mbox{\hyperlink{imag3d-cuda_8cu_afaf6dab3e9b4810733c8338a9e9c8e7c}{threadIdx}}.y\ *\ \mbox{\hyperlink{imag3d-cuda_8cu_afaf6dab3e9b4810733c8338a9e9c8e7c}{blockDim}}.x\ +\ \mbox{\hyperlink{imag3d-cuda_8cu_afaf6dab3e9b4810733c8338a9e9c8e7c}{threadIdx}}.z\ *\ \mbox{\hyperlink{imag3d-cuda_8cu_afaf6dab3e9b4810733c8338a9e9c8e7c}{blockDim}}.x\ *\ \mbox{\hyperlink{imag3d-cuda_8cu_afaf6dab3e9b4810733c8338a9e9c8e7c}{blockDim}}.y;}
\DoxyCodeLine{\Hypertarget{simpson3d__kernel_8cu_source_l00030}00030\ \ \ }
\DoxyCodeLine{\Hypertarget{simpson3d__kernel_8cu_source_l00031}00031\ \ \ \textcolor{comment}{//\ Calculate\ global\ 3D\ indices}}
\DoxyCodeLine{\Hypertarget{simpson3d__kernel_8cu_source_l00032}00032\ \ \ \textcolor{keywordtype}{long}\ \mbox{\hyperlink{imag3d-cuda_8cu_afaf6dab3e9b4810733c8338a9e9c8e7c}{idx}}\ =\ \mbox{\hyperlink{imag3d-cuda_8cu_afaf6dab3e9b4810733c8338a9e9c8e7c}{blockIdx}}.x\ *\ \mbox{\hyperlink{imag3d-cuda_8cu_afaf6dab3e9b4810733c8338a9e9c8e7c}{blockDim}}.x\ +\ \mbox{\hyperlink{imag3d-cuda_8cu_afaf6dab3e9b4810733c8338a9e9c8e7c}{threadIdx}}.x;}
\DoxyCodeLine{\Hypertarget{simpson3d__kernel_8cu_source_l00033}00033\ \ \ \textcolor{keywordtype}{long}\ \mbox{\hyperlink{imag3d-cuda_8cu_afaf6dab3e9b4810733c8338a9e9c8e7c}{idy}}\ =\ \mbox{\hyperlink{imag3d-cuda_8cu_afaf6dab3e9b4810733c8338a9e9c8e7c}{blockIdx}}.y\ *\ \mbox{\hyperlink{imag3d-cuda_8cu_afaf6dab3e9b4810733c8338a9e9c8e7c}{blockDim}}.y\ +\ \mbox{\hyperlink{imag3d-cuda_8cu_afaf6dab3e9b4810733c8338a9e9c8e7c}{threadIdx}}.y;}
\DoxyCodeLine{\Hypertarget{simpson3d__kernel_8cu_source_l00034}00034\ \ \ \textcolor{keywordtype}{long}\ \mbox{\hyperlink{imag3d-cuda_8cu_afaf6dab3e9b4810733c8338a9e9c8e7c}{idz\_global}}\ =\ \mbox{\hyperlink{imag3d-cuda_8cu_afaf6dab3e9b4810733c8338a9e9c8e7c}{z\_start}}\ +\ \mbox{\hyperlink{imag3d-cuda_8cu_afaf6dab3e9b4810733c8338a9e9c8e7c}{blockIdx}}.z\ *\ \mbox{\hyperlink{imag3d-cuda_8cu_afaf6dab3e9b4810733c8338a9e9c8e7c}{blockDim}}.z\ +\ \mbox{\hyperlink{imag3d-cuda_8cu_afaf6dab3e9b4810733c8338a9e9c8e7c}{threadIdx}}.z;\ \ \textcolor{comment}{//\ Global\ z\ index\ in\ full\ volume}}
\DoxyCodeLine{\Hypertarget{simpson3d__kernel_8cu_source_l00035}00035\ \ \ \textcolor{keywordtype}{long}\ \mbox{\hyperlink{imag3d-cuda_8cu_afaf6dab3e9b4810733c8338a9e9c8e7c}{idz\_local}}\ =\ \mbox{\hyperlink{imag3d-cuda_8cu_afaf6dab3e9b4810733c8338a9e9c8e7c}{blockIdx}}.z\ *\ \mbox{\hyperlink{imag3d-cuda_8cu_afaf6dab3e9b4810733c8338a9e9c8e7c}{blockDim}}.z\ +\ \mbox{\hyperlink{imag3d-cuda_8cu_afaf6dab3e9b4810733c8338a9e9c8e7c}{threadIdx}}.z;\ \ \textcolor{comment}{//\ Local\ z\ index\ within\ tile}}
\DoxyCodeLine{\Hypertarget{simpson3d__kernel_8cu_source_l00036}00036\ \ \ }
\DoxyCodeLine{\Hypertarget{simpson3d__kernel_8cu_source_l00037}00037\ \ \ \textcolor{keywordtype}{double}\ \mbox{\hyperlink{imag3d-cuda_8cu_afaf6dab3e9b4810733c8338a9e9c8e7c}{local\_sum}}\ =\ 0.0;}
\DoxyCodeLine{\Hypertarget{simpson3d__kernel_8cu_source_l00038}00038\ \ \ }
\DoxyCodeLine{\Hypertarget{simpson3d__kernel_8cu_source_l00039}00039\ \ \ \textcolor{comment}{//\ Check\ bounds\ and\ compute\ weighted\ value}}
\DoxyCodeLine{\Hypertarget{simpson3d__kernel_8cu_source_l00040}00040\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{imag3d-cuda_8cu_afaf6dab3e9b4810733c8338a9e9c8e7c}{idx}}\ <\ \mbox{\hyperlink{imag3d-cuda_8cuh_a97700218037a126a9957568d3fe1a8a9}{Nx}}\ \&\&\ \mbox{\hyperlink{imag3d-cuda_8cu_afaf6dab3e9b4810733c8338a9e9c8e7c}{idy}}\ <\ \mbox{\hyperlink{imag3d-cuda_8cuh_a8202396220c6bb040150929886702185}{Ny}}\ \&\&\ \mbox{\hyperlink{imag3d-cuda_8cu_afaf6dab3e9b4810733c8338a9e9c8e7c}{idz\_global}}\ <\ \mbox{\hyperlink{imag3d-cuda_8cuh_a51376252920a483727821c5db4ee36ff}{Nz}}\ \&\&\ \mbox{\hyperlink{imag3d-cuda_8cu_afaf6dab3e9b4810733c8338a9e9c8e7c}{idz\_local}}\ <\ tile\_size\_z)\ \{}
\DoxyCodeLine{\Hypertarget{simpson3d__kernel_8cu_source_l00041}00041\ \ \ \ \ \textcolor{comment}{//\ Use\ local\ index\ for\ accessing\ the\ tile\ data\ in\ memory}}
\DoxyCodeLine{\Hypertarget{simpson3d__kernel_8cu_source_l00042}00042\ \ \ \ \ \textcolor{keywordtype}{long}\ \mbox{\hyperlink{imag3d-cuda_8cu_afaf6dab3e9b4810733c8338a9e9c8e7c}{linear\_idx}}\ =\ \mbox{\hyperlink{imag3d-cuda_8cu_afaf6dab3e9b4810733c8338a9e9c8e7c}{idz\_local}}\ *\ \mbox{\hyperlink{imag3d-cuda_8cuh_a97700218037a126a9957568d3fe1a8a9}{Nx}}\ *\ \mbox{\hyperlink{imag3d-cuda_8cuh_a8202396220c6bb040150929886702185}{Ny}}\ +\ \mbox{\hyperlink{imag3d-cuda_8cu_afaf6dab3e9b4810733c8338a9e9c8e7c}{idy}}\ *\ \mbox{\hyperlink{imag3d-cuda_8cuh_a97700218037a126a9957568d3fe1a8a9}{Nx}}\ +\ \mbox{\hyperlink{imag3d-cuda_8cu_afaf6dab3e9b4810733c8338a9e9c8e7c}{idx}};}
\DoxyCodeLine{\Hypertarget{simpson3d__kernel_8cu_source_l00043}00043\ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{simpson3d__kernel_8cu_source_l00044}00044\ \ \ \ \ \textcolor{comment}{//\ Compute\ Simpson\ weights\ using\ GLOBAL\ indices\ (important\ for\ boundary\ conditions)}}
\DoxyCodeLine{\Hypertarget{simpson3d__kernel_8cu_source_l00045}00045\ \ \ \ \ \textcolor{keywordtype}{double}\ \mbox{\hyperlink{imag3d-cuda_8cu_afaf6dab3e9b4810733c8338a9e9c8e7c}{weight\_x}}\ =\ (\mbox{\hyperlink{imag3d-cuda_8cu_afaf6dab3e9b4810733c8338a9e9c8e7c}{idx}}\ ==\ 0\ ||\ \mbox{\hyperlink{imag3d-cuda_8cu_afaf6dab3e9b4810733c8338a9e9c8e7c}{idx}}\ ==\ \mbox{\hyperlink{imag3d-cuda_8cuh_a97700218037a126a9957568d3fe1a8a9}{Nx}}\ -\/\ 1)\ ?\ 1.0\ :\ (\mbox{\hyperlink{imag3d-cuda_8cu_afaf6dab3e9b4810733c8338a9e9c8e7c}{idx}}\ \%\ 2\ ==\ 1)\ ?\ 4.0\ :\ 2.0;}
\DoxyCodeLine{\Hypertarget{simpson3d__kernel_8cu_source_l00046}00046\ \ \ \ \ \textcolor{keywordtype}{double}\ \mbox{\hyperlink{imag3d-cuda_8cu_afaf6dab3e9b4810733c8338a9e9c8e7c}{weight\_y}}\ =\ (\mbox{\hyperlink{imag3d-cuda_8cu_afaf6dab3e9b4810733c8338a9e9c8e7c}{idy}}\ ==\ 0\ ||\ \mbox{\hyperlink{imag3d-cuda_8cu_afaf6dab3e9b4810733c8338a9e9c8e7c}{idy}}\ ==\ \mbox{\hyperlink{imag3d-cuda_8cuh_a8202396220c6bb040150929886702185}{Ny}}\ -\/\ 1)\ ?\ 1.0\ :\ (\mbox{\hyperlink{imag3d-cuda_8cu_afaf6dab3e9b4810733c8338a9e9c8e7c}{idy}}\ \%\ 2\ ==\ 1)\ ?\ 4.0\ :\ 2.0;}
\DoxyCodeLine{\Hypertarget{simpson3d__kernel_8cu_source_l00047}00047\ \ \ \ \ \textcolor{keywordtype}{double}\ \mbox{\hyperlink{imag3d-cuda_8cu_afaf6dab3e9b4810733c8338a9e9c8e7c}{weight\_z}}\ =\ (\mbox{\hyperlink{imag3d-cuda_8cu_afaf6dab3e9b4810733c8338a9e9c8e7c}{idz\_global}}\ ==\ 0\ ||\ \mbox{\hyperlink{imag3d-cuda_8cu_afaf6dab3e9b4810733c8338a9e9c8e7c}{idz\_global}}\ ==\ \mbox{\hyperlink{imag3d-cuda_8cuh_a51376252920a483727821c5db4ee36ff}{Nz}}\ -\/\ 1)\ ?\ 1.0\ :\ (\mbox{\hyperlink{imag3d-cuda_8cu_afaf6dab3e9b4810733c8338a9e9c8e7c}{idz\_global}}\ \%\ 2\ ==\ 1)\ ?\ 4.0\ :\ 2.0;}
\DoxyCodeLine{\Hypertarget{simpson3d__kernel_8cu_source_l00048}00048\ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{simpson3d__kernel_8cu_source_l00049}00049\ \ \ \ \ \mbox{\hyperlink{imag3d-cuda_8cu_afaf6dab3e9b4810733c8338a9e9c8e7c}{local\_sum}}\ =\ \mbox{\hyperlink{imag3d-cuda_8cu_afaf6dab3e9b4810733c8338a9e9c8e7c}{f}}[\mbox{\hyperlink{imag3d-cuda_8cu_afaf6dab3e9b4810733c8338a9e9c8e7c}{linear\_idx}}]\ *\ \mbox{\hyperlink{imag3d-cuda_8cu_afaf6dab3e9b4810733c8338a9e9c8e7c}{weight\_x}}\ *\ \mbox{\hyperlink{imag3d-cuda_8cu_afaf6dab3e9b4810733c8338a9e9c8e7c}{weight\_y}}\ *\ \mbox{\hyperlink{imag3d-cuda_8cu_afaf6dab3e9b4810733c8338a9e9c8e7c}{weight\_z}};}
\DoxyCodeLine{\Hypertarget{simpson3d__kernel_8cu_source_l00050}00050\ \ \ \}}
\DoxyCodeLine{\Hypertarget{simpson3d__kernel_8cu_source_l00051}00051\ \ \ }
\DoxyCodeLine{\Hypertarget{simpson3d__kernel_8cu_source_l00052}00052\ \ \ \textcolor{comment}{//\ Store\ in\ shared\ memory\ for\ reduction}}
\DoxyCodeLine{\Hypertarget{simpson3d__kernel_8cu_source_l00053}00053\ \ \ \mbox{\hyperlink{imag3d-cuda_8cu_afaf6dab3e9b4810733c8338a9e9c8e7c}{sdata}}[\mbox{\hyperlink{imag3d-cuda_8cu_afaf6dab3e9b4810733c8338a9e9c8e7c}{tid}}]\ =\ \mbox{\hyperlink{imag3d-cuda_8cu_afaf6dab3e9b4810733c8338a9e9c8e7c}{local\_sum}};}
\DoxyCodeLine{\Hypertarget{simpson3d__kernel_8cu_source_l00054}00054\ \ \ \mbox{\hyperlink{imag3d-cuda_8cu_afaf6dab3e9b4810733c8338a9e9c8e7c}{\_\_syncthreads}}();}
\DoxyCodeLine{\Hypertarget{simpson3d__kernel_8cu_source_l00055}00055\ \ \ }
\DoxyCodeLine{\Hypertarget{simpson3d__kernel_8cu_source_l00056}00056\ \ \ \textcolor{comment}{//\ Perform\ tree-\/based\ reduction\ in\ shared\ memory}}
\DoxyCodeLine{\Hypertarget{simpson3d__kernel_8cu_source_l00057}00057\ \ \ \textcolor{keywordtype}{long}\ \mbox{\hyperlink{imag3d-cuda_8cu_afaf6dab3e9b4810733c8338a9e9c8e7c}{block\_size}}\ =\ \mbox{\hyperlink{imag3d-cuda_8cu_afaf6dab3e9b4810733c8338a9e9c8e7c}{blockDim}}.x\ *\ \mbox{\hyperlink{imag3d-cuda_8cu_afaf6dab3e9b4810733c8338a9e9c8e7c}{blockDim}}.y\ *\ \mbox{\hyperlink{imag3d-cuda_8cu_afaf6dab3e9b4810733c8338a9e9c8e7c}{blockDim}}.z;}
\DoxyCodeLine{\Hypertarget{simpson3d__kernel_8cu_source_l00058}00058\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{imag3d-cuda_8cu_afaf6dab3e9b4810733c8338a9e9c8e7c}{s}}\ =\ \mbox{\hyperlink{imag3d-cuda_8cu_afaf6dab3e9b4810733c8338a9e9c8e7c}{block\_size}}\ /\ 2;\ \mbox{\hyperlink{imag3d-cuda_8cu_afaf6dab3e9b4810733c8338a9e9c8e7c}{s}}\ >\ 0;\ \mbox{\hyperlink{imag3d-cuda_8cu_afaf6dab3e9b4810733c8338a9e9c8e7c}{s}}\ >>=\ 1)\ \{}
\DoxyCodeLine{\Hypertarget{simpson3d__kernel_8cu_source_l00059}00059\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{imag3d-cuda_8cu_afaf6dab3e9b4810733c8338a9e9c8e7c}{tid}}\ <\ \mbox{\hyperlink{imag3d-cuda_8cu_afaf6dab3e9b4810733c8338a9e9c8e7c}{s}}\ \&\&\ \mbox{\hyperlink{imag3d-cuda_8cu_afaf6dab3e9b4810733c8338a9e9c8e7c}{tid}}\ +\ \mbox{\hyperlink{imag3d-cuda_8cu_afaf6dab3e9b4810733c8338a9e9c8e7c}{s}}\ <\ \mbox{\hyperlink{imag3d-cuda_8cu_afaf6dab3e9b4810733c8338a9e9c8e7c}{block\_size}})\ \{}
\DoxyCodeLine{\Hypertarget{simpson3d__kernel_8cu_source_l00060}00060\ \ \ \ \ \ \ \mbox{\hyperlink{imag3d-cuda_8cu_afaf6dab3e9b4810733c8338a9e9c8e7c}{sdata}}[\mbox{\hyperlink{imag3d-cuda_8cu_afaf6dab3e9b4810733c8338a9e9c8e7c}{tid}}]\ +=\ \mbox{\hyperlink{imag3d-cuda_8cu_afaf6dab3e9b4810733c8338a9e9c8e7c}{sdata}}[\mbox{\hyperlink{imag3d-cuda_8cu_afaf6dab3e9b4810733c8338a9e9c8e7c}{tid}}\ +\ \mbox{\hyperlink{imag3d-cuda_8cu_afaf6dab3e9b4810733c8338a9e9c8e7c}{s}}];}
\DoxyCodeLine{\Hypertarget{simpson3d__kernel_8cu_source_l00061}00061\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{simpson3d__kernel_8cu_source_l00062}00062\ \ \ \ \ \mbox{\hyperlink{imag3d-cuda_8cu_afaf6dab3e9b4810733c8338a9e9c8e7c}{\_\_syncthreads}}();}
\DoxyCodeLine{\Hypertarget{simpson3d__kernel_8cu_source_l00063}00063\ \ \ \}}
\DoxyCodeLine{\Hypertarget{simpson3d__kernel_8cu_source_l00064}00064\ \ \ }
\DoxyCodeLine{\Hypertarget{simpson3d__kernel_8cu_source_l00065}00065\ \ \ \textcolor{comment}{//\ Thread\ 0\ adds\ the\ block's\ sum\ to\ global\ result}}
\DoxyCodeLine{\Hypertarget{simpson3d__kernel_8cu_source_l00066}00066\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{imag3d-cuda_8cu_afaf6dab3e9b4810733c8338a9e9c8e7c}{tid}}\ ==\ 0)\ \{}
\DoxyCodeLine{\Hypertarget{simpson3d__kernel_8cu_source_l00067}00067\ \ \ \ \ \mbox{\hyperlink{imag3d-cuda_8cu_afaf6dab3e9b4810733c8338a9e9c8e7c}{atomicAdd}}(\&\mbox{\hyperlink{imag3d-cuda_8cu_afaf6dab3e9b4810733c8338a9e9c8e7c}{partial\_sums}}[0],\ \mbox{\hyperlink{imag3d-cuda_8cu_afaf6dab3e9b4810733c8338a9e9c8e7c}{sdata}}[0]);}
\DoxyCodeLine{\Hypertarget{simpson3d__kernel_8cu_source_l00068}00068\ \ \ \}}
\DoxyCodeLine{\Hypertarget{simpson3d__kernel_8cu_source_l00069}00069\ \}}
\DoxyCodeLine{\Hypertarget{simpson3d__kernel_8cu_source_l00070}00070\ }
\DoxyCodeLine{\Hypertarget{simpson3d__kernel_8cu_source_l00082}\mbox{\hyperlink{simpson3d__kernel_8cu_a99f63c72c09355d8a595f34f0a9fc34e}{00082}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{simpson3d__kernel_8cu_a99f63c72c09355d8a595f34f0a9fc34e}{launchSimpson3DKernel}}(\textcolor{keywordtype}{double}*\ d\_f,\ \textcolor{keywordtype}{double}*\ d\_partial\_sum,}
\DoxyCodeLine{\Hypertarget{simpson3d__kernel_8cu_source_l00083}00083\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{long}\ \mbox{\hyperlink{imag3d-cuda_8cuh_a97700218037a126a9957568d3fe1a8a9}{Nx}},\ \textcolor{keywordtype}{long}\ \mbox{\hyperlink{imag3d-cuda_8cuh_a8202396220c6bb040150929886702185}{Ny}},\ \textcolor{keywordtype}{long}\ \mbox{\hyperlink{imag3d-cuda_8cuh_a51376252920a483727821c5db4ee36ff}{Nz}},}
\DoxyCodeLine{\Hypertarget{simpson3d__kernel_8cu_source_l00084}00084\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{long}\ tile\_size\_z,\ \textcolor{keywordtype}{long}\ \mbox{\hyperlink{imag3d-cuda_8cu_afaf6dab3e9b4810733c8338a9e9c8e7c}{z\_start}},}
\DoxyCodeLine{\Hypertarget{simpson3d__kernel_8cu_source_l00085}00085\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{long}\ \mbox{\hyperlink{imag3d-cuda_8cu_afaf6dab3e9b4810733c8338a9e9c8e7c}{current\_tile\_z}})\ \{}
\DoxyCodeLine{\Hypertarget{simpson3d__kernel_8cu_source_l00086}00086\ \ \ \ \ \textcolor{comment}{//\ Configure\ kernel\ launch\ parameters}}
\DoxyCodeLine{\Hypertarget{simpson3d__kernel_8cu_source_l00087}00087\ \ \ \ \ dim3\ \mbox{\hyperlink{imag3d-cuda_8cu_afaf6dab3e9b4810733c8338a9e9c8e7c}{blockSize}}(8,\ 8,\ 4);\ \ \textcolor{comment}{//\ 8*8*4\ =\ 256\ threads\ per\ block}}
\DoxyCodeLine{\Hypertarget{simpson3d__kernel_8cu_source_l00088}00088\ \ \ \ \ dim3\ \mbox{\hyperlink{imag3d-cuda_8cu_afaf6dab3e9b4810733c8338a9e9c8e7c}{gridSize}}((\mbox{\hyperlink{imag3d-cuda_8cuh_a97700218037a126a9957568d3fe1a8a9}{Nx}}\ +\ \mbox{\hyperlink{imag3d-cuda_8cu_afaf6dab3e9b4810733c8338a9e9c8e7c}{blockSize}}.x\ -\/\ 1)\ /\ \mbox{\hyperlink{imag3d-cuda_8cu_afaf6dab3e9b4810733c8338a9e9c8e7c}{blockSize}}.x,}
\DoxyCodeLine{\Hypertarget{simpson3d__kernel_8cu_source_l00089}00089\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (\mbox{\hyperlink{imag3d-cuda_8cuh_a8202396220c6bb040150929886702185}{Ny}}\ +\ \mbox{\hyperlink{imag3d-cuda_8cu_afaf6dab3e9b4810733c8338a9e9c8e7c}{blockSize}}.y\ -\/\ 1)\ /\ \mbox{\hyperlink{imag3d-cuda_8cu_afaf6dab3e9b4810733c8338a9e9c8e7c}{blockSize}}.y,}
\DoxyCodeLine{\Hypertarget{simpson3d__kernel_8cu_source_l00090}00090\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (\mbox{\hyperlink{imag3d-cuda_8cu_afaf6dab3e9b4810733c8338a9e9c8e7c}{current\_tile\_z}}\ +\ \mbox{\hyperlink{imag3d-cuda_8cu_afaf6dab3e9b4810733c8338a9e9c8e7c}{blockSize}}.z\ -\/\ 1)\ /\ \mbox{\hyperlink{imag3d-cuda_8cu_afaf6dab3e9b4810733c8338a9e9c8e7c}{blockSize}}.z);}
\DoxyCodeLine{\Hypertarget{simpson3d__kernel_8cu_source_l00091}00091\ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{simpson3d__kernel_8cu_source_l00092}00092\ \ \ \ \ \textcolor{comment}{//\ Calculate\ shared\ memory\ size\ for\ reduction}}
\DoxyCodeLine{\Hypertarget{simpson3d__kernel_8cu_source_l00093}00093\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{imag3d-cuda_8cu_afaf6dab3e9b4810733c8338a9e9c8e7c}{shared\_mem\_size}}\ =\ \mbox{\hyperlink{imag3d-cuda_8cu_afaf6dab3e9b4810733c8338a9e9c8e7c}{blockSize}}.x\ *\ \mbox{\hyperlink{imag3d-cuda_8cu_afaf6dab3e9b4810733c8338a9e9c8e7c}{blockSize}}.y\ *\ \mbox{\hyperlink{imag3d-cuda_8cu_afaf6dab3e9b4810733c8338a9e9c8e7c}{blockSize}}.z\ *\ \textcolor{keyword}{sizeof}(\mbox{\hyperlink{imag3d-cuda_8cu_afaf6dab3e9b4810733c8338a9e9c8e7c}{double}});}
\DoxyCodeLine{\Hypertarget{simpson3d__kernel_8cu_source_l00094}00094\ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{simpson3d__kernel_8cu_source_l00095}00095\ \ \ \ \ \textcolor{comment}{//\ Launch\ kernel}}
\DoxyCodeLine{\Hypertarget{simpson3d__kernel_8cu_source_l00096}00096\ \ \ \ \ \mbox{\hyperlink{imag3d-cuda_8cu_afaf6dab3e9b4810733c8338a9e9c8e7c}{simpson3d\_tiled\_reduce<<<gridSize,\ blockSize,\ shared\_mem\_size>}}>>(}
\DoxyCodeLine{\Hypertarget{simpson3d__kernel_8cu_source_l00097}00097\ \ \ \ \ \ \ \ \ d\_f,\ d\_partial\_sum,\ \mbox{\hyperlink{imag3d-cuda_8cuh_a97700218037a126a9957568d3fe1a8a9}{Nx}},\ \mbox{\hyperlink{imag3d-cuda_8cuh_a8202396220c6bb040150929886702185}{Ny}},\ \mbox{\hyperlink{imag3d-cuda_8cuh_a51376252920a483727821c5db4ee36ff}{Nz}},\ \mbox{\hyperlink{imag3d-cuda_8cu_afaf6dab3e9b4810733c8338a9e9c8e7c}{current\_tile\_z}},\ \mbox{\hyperlink{imag3d-cuda_8cu_afaf6dab3e9b4810733c8338a9e9c8e7c}{z\_start}});}
\DoxyCodeLine{\Hypertarget{simpson3d__kernel_8cu_source_l00098}00098\ \}}
\DoxyCodeLine{\Hypertarget{simpson3d__kernel_8cu_source_l00099}00099\ }
\DoxyCodeLine{\Hypertarget{simpson3d__kernel_8cu_source_l00105}\mbox{\hyperlink{simpson3d__kernel_8cu_a021e09a5e642ceda94915c02626f0c92}{00105}}\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ \mbox{\hyperlink{simpson3d__kernel_8cu_a021e09a5e642ceda94915c02626f0c92}{getCudaErrorString}}(\mbox{\hyperlink{imag3d-cuda_8cu_afaf6dab3e9b4810733c8338a9e9c8e7c}{cudaError\_t}}\ \mbox{\hyperlink{imag3d-cuda_8cu_afaf6dab3e9b4810733c8338a9e9c8e7c}{error}})\ \{}
\DoxyCodeLine{\Hypertarget{simpson3d__kernel_8cu_source_l00106}00106\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{imag3d-cuda_8cu_afaf6dab3e9b4810733c8338a9e9c8e7c}{cudaGetErrorString}}(\mbox{\hyperlink{imag3d-cuda_8cu_afaf6dab3e9b4810733c8338a9e9c8e7c}{error}});}
\DoxyCodeLine{\Hypertarget{simpson3d__kernel_8cu_source_l00107}00107\ \}}

\end{DoxyCode}
