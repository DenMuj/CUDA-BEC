\doxysection{Cuda\+Array.\+cpp}
\hypertarget{CudaArray_8cpp_source}{}\label{CudaArray_8cpp_source}\index{src/utils/CudaArray.cpp@{src/utils/CudaArray.cpp}}
\mbox{\hyperlink{CudaArray_8cpp}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00001}00001\ }
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00010}00010\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{CudaArray_8h}{CudaArray.h}}"{}}}
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00011}00011\ \textcolor{preprocessor}{\#include\ <stdexcept>}}
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00012}00012\ \textcolor{preprocessor}{\#include\ <cstring>}}
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00013}00013\ }
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00021}00021\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ T>}
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00022}\mbox{\hyperlink{classCudaArray3D_a0dd7d8c7b18c4e472eae70e768fe486f}{00022}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classCudaArray3D_a0dd7d8c7b18c4e472eae70e768fe486f}{CudaArray3D<T>::reset}}()\ \{}
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00023}00023\ \ \ \ \ pitched\_ptr\ =\ \mbox{\hyperlink{imag3d-cuda_8cu_abd2b66af1c3a4c07f9d40003c17aceb2}{make\_cudaPitchedPtr}}(\textcolor{keyword}{nullptr},\ 0,\ 0,\ 0);}
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00024}00024\ \ \ \ \ d\_data\_linear\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00025}00025\ \ \ \ \ nx\ =\ ny\ =\ nz\ =\ 0;}
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00026}00026\ \ \ \ \ total\_elements\ =\ 0;}
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00027}00027\ \ \ \ \ pitch\ =\ 0;}
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00028}00028\ \ \ \ \ use\_pitched\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00029}00029\ \}}
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00030}00030\ }
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00031}00031\ \textcolor{comment}{//\ ==========\ CONSTRUCTORS\ AND\ DESTRUCTOR\ ==========}}
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00032}00032\ }
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00041}00041\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ T>}
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00042}\mbox{\hyperlink{classCudaArray3D_a18cedf92dc03e3490ad45dbf09b18c30}{00042}}\ \mbox{\hyperlink{classCudaArray3D_a18cedf92dc03e3490ad45dbf09b18c30}{CudaArray3D<T>::CudaArray3D}}(\textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{imag3d-cuda_8cu_abd2b66af1c3a4c07f9d40003c17aceb2}{nx\_}},\ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{imag3d-cuda_8cu_abd2b66af1c3a4c07f9d40003c17aceb2}{ny\_}},\ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{imag3d-cuda_8cu_abd2b66af1c3a4c07f9d40003c17aceb2}{nz\_}},\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{imag3d-cuda_8cu_abd2b66af1c3a4c07f9d40003c17aceb2}{use\_pitched\_memory}})\ }
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00043}00043\ \ \ \ \ :\ nx(\mbox{\hyperlink{imag3d-cuda_8cu_abd2b66af1c3a4c07f9d40003c17aceb2}{nx\_}}),\ ny(\mbox{\hyperlink{imag3d-cuda_8cu_abd2b66af1c3a4c07f9d40003c17aceb2}{ny\_}}),\ nz(\mbox{\hyperlink{imag3d-cuda_8cu_abd2b66af1c3a4c07f9d40003c17aceb2}{nz\_}}),\ total\_elements(\mbox{\hyperlink{imag3d-cuda_8cu_abd2b66af1c3a4c07f9d40003c17aceb2}{nx\_}}\ *\ \mbox{\hyperlink{imag3d-cuda_8cu_abd2b66af1c3a4c07f9d40003c17aceb2}{ny\_}}\ *\ \mbox{\hyperlink{imag3d-cuda_8cu_abd2b66af1c3a4c07f9d40003c17aceb2}{nz\_}}),\ }
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00044}00044\ \ \ \ \ \ \ use\_pitched(\mbox{\hyperlink{imag3d-cuda_8cu_abd2b66af1c3a4c07f9d40003c17aceb2}{use\_pitched\_memory}}),\ d\_data\_linear(\mbox{\hyperlink{imag3d-cuda_8cu_abd2b66af1c3a4c07f9d40003c17aceb2}{nullptr}})\ \{}
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00045}00045\ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00046}00046\ \ \ \ \ \mbox{\hyperlink{classCudaArray3D_adf17aa66059ebcb181ba842aaffc6b53}{pitched\_ptr}}\ =\ \mbox{\hyperlink{imag3d-cuda_8cu_abd2b66af1c3a4c07f9d40003c17aceb2}{make\_cudaPitchedPtr}}(\textcolor{keyword}{nullptr},\ 0,\ 0,\ 0);}
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00047}00047\ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00048}00048\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classCudaArray3D_a6532b367fc032a52949d3033911052e5}{total\_elements}}\ >\ 0)\ \{}
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00049}00049\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classCudaArray3D_ac5af9427e877ef54dee96e7c0757275d}{use\_pitched}}\ \&\&\ \mbox{\hyperlink{classCudaArray3D_a6a3e83389a476d5ae5abff149d57cd29}{nz}}\ >\ 1\ \&\&\ \mbox{\hyperlink{classCudaArray3D_ace580a5eba659ae2eb6a5f9728addffd}{ny}}\ >\ 1)\ \{}
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00050}00050\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ =====\ TRUE\ 3D\ ALLOCATION\ (nz\ >\ 1,\ ny\ >\ 1)\ =====}}
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00051}00051\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Use\ cudaMalloc3D\ for\ optimal\ 3D\ memory\ layout\ with\ hardware\ alignment}}
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00052}00052\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{imag3d-cuda_8cu_abd2b66af1c3a4c07f9d40003c17aceb2}{cudaExtent}}\ \mbox{\hyperlink{imag3d-cuda_8cu_abd2b66af1c3a4c07f9d40003c17aceb2}{extent}}\ =\ \mbox{\hyperlink{imag3d-cuda_8cu_abd2b66af1c3a4c07f9d40003c17aceb2}{make\_cudaExtent}}(\mbox{\hyperlink{classCudaArray3D_af7396181987682f1e1acb7a078e795ef}{nx}}\ *\ \textcolor{keyword}{sizeof}(\mbox{\hyperlink{imag3d-cuda_8cu_abd2b66af1c3a4c07f9d40003c17aceb2}{T}}),\ \mbox{\hyperlink{classCudaArray3D_ace580a5eba659ae2eb6a5f9728addffd}{ny}},\ \mbox{\hyperlink{classCudaArray3D_a6a3e83389a476d5ae5abff149d57cd29}{nz}});}
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00053}00053\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{imag3d-cuda_8cu_abd2b66af1c3a4c07f9d40003c17aceb2}{cudaError\_t}}\ \mbox{\hyperlink{imag3d-cuda_8cu_abd2b66af1c3a4c07f9d40003c17aceb2}{error}}\ =\ \mbox{\hyperlink{imag3d-cuda_8cu_abd2b66af1c3a4c07f9d40003c17aceb2}{cudaMalloc3D}}(\&\mbox{\hyperlink{classCudaArray3D_adf17aa66059ebcb181ba842aaffc6b53}{pitched\_ptr}},\ \mbox{\hyperlink{imag3d-cuda_8cu_abd2b66af1c3a4c07f9d40003c17aceb2}{extent}});}
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00054}00054\ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00055}00055\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{imag3d-cuda_8cu_abd2b66af1c3a4c07f9d40003c17aceb2}{error}}\ !=\ \mbox{\hyperlink{imag3d-cuda_8cu_abd2b66af1c3a4c07f9d40003c17aceb2}{cudaSuccess}})\ \{}
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00056}00056\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ 3D\ pitched\ allocation\ failed\ -\/\ fallback\ to\ linear\ memory}}
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00057}00057\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classCudaArray3D_ac5af9427e877ef54dee96e7c0757275d}{use\_pitched}}\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00058}00058\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{imag3d-cuda_8cu_abd2b66af1c3a4c07f9d40003c17aceb2}{bytes}}\ =\ \mbox{\hyperlink{classCudaArray3D_a6532b367fc032a52949d3033911052e5}{total\_elements}}\ *\ \textcolor{keyword}{sizeof}(\mbox{\hyperlink{imag3d-cuda_8cu_abd2b66af1c3a4c07f9d40003c17aceb2}{T}});}
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00059}00059\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{imag3d-cuda_8cu_abd2b66af1c3a4c07f9d40003c17aceb2}{error}}\ =\ \mbox{\hyperlink{imag3d-cuda_8cu_abd2b66af1c3a4c07f9d40003c17aceb2}{cudaMalloc}}((\textcolor{keywordtype}{void}**)\&\mbox{\hyperlink{classCudaArray3D_aa33f6b4a749a4006bb44a9fb22766c38}{d\_data\_linear}},\ \mbox{\hyperlink{imag3d-cuda_8cu_abd2b66af1c3a4c07f9d40003c17aceb2}{bytes}});}
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00060}00060\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classCudaArray3D_afdeb0db2f7018394c01684b2a1f0bbe5}{checkCudaError}}(\mbox{\hyperlink{imag3d-cuda_8cu_abd2b66af1c3a4c07f9d40003c17aceb2}{error}},\ \textcolor{stringliteral}{"{}Failed\ to\ allocate\ device\ memory"{}});}
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00061}00061\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classCudaArray3D_aead05679620bc9a72a8b1b666850b52a}{pitch}}\ =\ \mbox{\hyperlink{classCudaArray3D_af7396181987682f1e1acb7a078e795ef}{nx}}\ *\ \textcolor{keyword}{sizeof}(\mbox{\hyperlink{imag3d-cuda_8cu_abd2b66af1c3a4c07f9d40003c17aceb2}{T}});\ \ \textcolor{comment}{//\ No\ actual\ pitch\ in\ linear\ memory}}
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00062}00062\ \ \ \ \ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00063}00063\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ 3D\ pitched\ allocation\ succeeded}}
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00064}00064\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classCudaArray3D_aead05679620bc9a72a8b1b666850b52a}{pitch}}\ =\ \mbox{\hyperlink{classCudaArray3D_adf17aa66059ebcb181ba842aaffc6b53}{pitched\_ptr}}.pitch;}
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00065}00065\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00066}00066\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classCudaArray3D_ac5af9427e877ef54dee96e7c0757275d}{use\_pitched}}\ \&\&\ \mbox{\hyperlink{classCudaArray3D_ace580a5eba659ae2eb6a5f9728addffd}{ny}}\ >\ 1)\ \{}
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00067}00067\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ =====\ 2D\ ALLOCATION\ (nz\ =\ 1,\ ny\ >\ 1)\ =====}}
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00068}00068\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Use\ cudaMallocPitch\ for\ optimal\ 2D\ memory\ layout}}
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00069}00069\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{imag3d-cuda_8cu_abd2b66af1c3a4c07f9d40003c17aceb2}{width}}\ =\ \mbox{\hyperlink{classCudaArray3D_af7396181987682f1e1acb7a078e795ef}{nx}}\ *\ \textcolor{keyword}{sizeof}(\mbox{\hyperlink{imag3d-cuda_8cu_abd2b66af1c3a4c07f9d40003c17aceb2}{T}});}
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00070}00070\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{imag3d-cuda_8cu_abd2b66af1c3a4c07f9d40003c17aceb2}{height}}\ =\ \mbox{\hyperlink{classCudaArray3D_ace580a5eba659ae2eb6a5f9728addffd}{ny}}\ *\ \mbox{\hyperlink{classCudaArray3D_a6a3e83389a476d5ae5abff149d57cd29}{nz}};\ \ \textcolor{comment}{//\ For\ 2D:\ nz=1,\ so\ height\ =\ ny}}
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00071}00071\ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00072}00072\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{imag3d-cuda_8cu_abd2b66af1c3a4c07f9d40003c17aceb2}{T}}*\ \mbox{\hyperlink{imag3d-cuda_8cu_abd2b66af1c3a4c07f9d40003c17aceb2}{ptr2d}};}
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00073}00073\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{imag3d-cuda_8cu_abd2b66af1c3a4c07f9d40003c17aceb2}{cudaError\_t}}\ \mbox{\hyperlink{imag3d-cuda_8cu_abd2b66af1c3a4c07f9d40003c17aceb2}{error}}\ =\ \mbox{\hyperlink{imag3d-cuda_8cu_abd2b66af1c3a4c07f9d40003c17aceb2}{cudaMallocPitch}}((\textcolor{keywordtype}{void}**)\&\mbox{\hyperlink{imag3d-cuda_8cu_abd2b66af1c3a4c07f9d40003c17aceb2}{ptr2d}},\ \&\mbox{\hyperlink{classCudaArray3D_aead05679620bc9a72a8b1b666850b52a}{pitch}},\ \mbox{\hyperlink{imag3d-cuda_8cu_abd2b66af1c3a4c07f9d40003c17aceb2}{width}},\ \mbox{\hyperlink{imag3d-cuda_8cu_abd2b66af1c3a4c07f9d40003c17aceb2}{height}});}
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00074}00074\ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00075}00075\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{imag3d-cuda_8cu_abd2b66af1c3a4c07f9d40003c17aceb2}{error}}\ !=\ \mbox{\hyperlink{imag3d-cuda_8cu_abd2b66af1c3a4c07f9d40003c17aceb2}{cudaSuccess}})\ \{}
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00076}00076\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ 2D\ pitched\ allocation\ failed\ -\/\ fallback\ to\ linear\ memory}}
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00077}00077\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classCudaArray3D_ac5af9427e877ef54dee96e7c0757275d}{use\_pitched}}\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00078}00078\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{imag3d-cuda_8cu_abd2b66af1c3a4c07f9d40003c17aceb2}{bytes}}\ =\ \mbox{\hyperlink{classCudaArray3D_a6532b367fc032a52949d3033911052e5}{total\_elements}}\ *\ \textcolor{keyword}{sizeof}(\mbox{\hyperlink{imag3d-cuda_8cu_abd2b66af1c3a4c07f9d40003c17aceb2}{T}});}
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00079}00079\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{imag3d-cuda_8cu_abd2b66af1c3a4c07f9d40003c17aceb2}{error}}\ =\ \mbox{\hyperlink{imag3d-cuda_8cu_abd2b66af1c3a4c07f9d40003c17aceb2}{cudaMalloc}}((\textcolor{keywordtype}{void}**)\&\mbox{\hyperlink{classCudaArray3D_aa33f6b4a749a4006bb44a9fb22766c38}{d\_data\_linear}},\ \mbox{\hyperlink{imag3d-cuda_8cu_abd2b66af1c3a4c07f9d40003c17aceb2}{bytes}});}
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00080}00080\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classCudaArray3D_afdeb0db2f7018394c01684b2a1f0bbe5}{checkCudaError}}(\mbox{\hyperlink{imag3d-cuda_8cu_abd2b66af1c3a4c07f9d40003c17aceb2}{error}},\ \textcolor{stringliteral}{"{}Failed\ to\ allocate\ device\ memory"{}});}
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00081}00081\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classCudaArray3D_aead05679620bc9a72a8b1b666850b52a}{pitch}}\ =\ \mbox{\hyperlink{classCudaArray3D_af7396181987682f1e1acb7a078e795ef}{nx}}\ *\ \textcolor{keyword}{sizeof}(\mbox{\hyperlink{imag3d-cuda_8cu_abd2b66af1c3a4c07f9d40003c17aceb2}{T}});\ \ \textcolor{comment}{//\ No\ actual\ pitch\ in\ linear\ memory}}
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00082}00082\ \ \ \ \ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00083}00083\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ 2D\ pitched\ allocation\ succeeded\ -\/\ wrap\ in\ 3D\ structure\ for\ consistency}}
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00084}00084\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classCudaArray3D_adf17aa66059ebcb181ba842aaffc6b53}{pitched\_ptr}}\ =\ \mbox{\hyperlink{imag3d-cuda_8cu_abd2b66af1c3a4c07f9d40003c17aceb2}{make\_cudaPitchedPtr}}(\mbox{\hyperlink{imag3d-cuda_8cu_abd2b66af1c3a4c07f9d40003c17aceb2}{ptr2d}},\ \mbox{\hyperlink{classCudaArray3D_aead05679620bc9a72a8b1b666850b52a}{pitch}},\ \mbox{\hyperlink{classCudaArray3D_af7396181987682f1e1acb7a078e795ef}{nx}}\ *\ \textcolor{keyword}{sizeof}(\mbox{\hyperlink{imag3d-cuda_8cu_abd2b66af1c3a4c07f9d40003c17aceb2}{T}}),\ \mbox{\hyperlink{classCudaArray3D_ace580a5eba659ae2eb6a5f9728addffd}{ny}});}
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00085}00085\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00086}00086\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00087}00087\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ =====\ LINEAR\ ALLOCATION\ =====}}
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00088}00088\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ For\ 1D\ arrays,\ when\ pitched\ memory\ is\ not\ requested,\ or\ as\ fallback}}
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00089}00089\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classCudaArray3D_ac5af9427e877ef54dee96e7c0757275d}{use\_pitched}}\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00090}00090\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{imag3d-cuda_8cu_abd2b66af1c3a4c07f9d40003c17aceb2}{bytes}}\ =\ \mbox{\hyperlink{classCudaArray3D_a6532b367fc032a52949d3033911052e5}{total\_elements}}\ *\ \textcolor{keyword}{sizeof}(\mbox{\hyperlink{imag3d-cuda_8cu_abd2b66af1c3a4c07f9d40003c17aceb2}{T}});}
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00091}00091\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{imag3d-cuda_8cu_abd2b66af1c3a4c07f9d40003c17aceb2}{cudaError\_t}}\ \mbox{\hyperlink{imag3d-cuda_8cu_abd2b66af1c3a4c07f9d40003c17aceb2}{error}}\ =\ \mbox{\hyperlink{imag3d-cuda_8cu_abd2b66af1c3a4c07f9d40003c17aceb2}{cudaMalloc}}((\textcolor{keywordtype}{void}**)\&\mbox{\hyperlink{classCudaArray3D_aa33f6b4a749a4006bb44a9fb22766c38}{d\_data\_linear}},\ \mbox{\hyperlink{imag3d-cuda_8cu_abd2b66af1c3a4c07f9d40003c17aceb2}{bytes}});}
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00092}00092\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classCudaArray3D_afdeb0db2f7018394c01684b2a1f0bbe5}{checkCudaError}}(\mbox{\hyperlink{imag3d-cuda_8cu_abd2b66af1c3a4c07f9d40003c17aceb2}{error}},\ \textcolor{stringliteral}{"{}Failed\ to\ allocate\ device\ memory"{}});}
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00093}00093\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classCudaArray3D_aead05679620bc9a72a8b1b666850b52a}{pitch}}\ =\ \mbox{\hyperlink{classCudaArray3D_af7396181987682f1e1acb7a078e795ef}{nx}}\ *\ \textcolor{keyword}{sizeof}(\mbox{\hyperlink{imag3d-cuda_8cu_abd2b66af1c3a4c07f9d40003c17aceb2}{T}});\ \ \textcolor{comment}{//\ Conceptual\ pitch\ for\ consistency}}
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00094}00094\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00095}00095\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00096}00096\ \}}
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00097}00097\ }
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00104}00104\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ T>}
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00105}\mbox{\hyperlink{classCudaArray3D_aacc6263600f8a8df7e1006c208936aa9}{00105}}\ \mbox{\hyperlink{classCudaArray3D_a18cedf92dc03e3490ad45dbf09b18c30}{CudaArray3D<T>::CudaArray3D}}(\textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{imag3d-cuda_8cu_abd2b66af1c3a4c07f9d40003c17aceb2}{n}})\ :\ \mbox{\hyperlink{classCudaArray3D}{CudaArray3D}}(\mbox{\hyperlink{imag3d-cuda_8cu_abd2b66af1c3a4c07f9d40003c17aceb2}{n}},\ 1,\ 1,\ \mbox{\hyperlink{imag3d-cuda_8cu_abd2b66af1c3a4c07f9d40003c17aceb2}{false}})\ \{}
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00106}00106\ \ \ \ \ \textcolor{comment}{//\ Delegates\ to\ 3D\ constructor\ with\ ny=1,\ nz=1,\ and\ no\ pitched\ memory}}
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00107}00107\ \}}
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00108}00108\ }
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00116}00116\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ T>}
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00117}\mbox{\hyperlink{classCudaArray3D_a02b245779a2a8a5c25549a486fc2b03d}{00117}}\ \mbox{\hyperlink{classCudaArray3D_a02b245779a2a8a5c25549a486fc2b03d}{CudaArray3D<T>::\string~CudaArray3D}}()\ \{}
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00118}00118\ \ \ \ \ \textcolor{keywordflow}{if}\ (use\_pitched\ \&\&\ pitched\_ptr.ptr\ !=\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00119}00119\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{imag3d-cuda_8cu_abd2b66af1c3a4c07f9d40003c17aceb2}{cudaFree}}(pitched\_ptr.ptr);\ \ \textcolor{comment}{//\ Free\ pitched\ memory}}
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00120}00120\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (d\_data\_linear\ !=\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00121}00121\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{imag3d-cuda_8cu_abd2b66af1c3a4c07f9d40003c17aceb2}{cudaFree}}(d\_data\_linear);\ \ \ \ \textcolor{comment}{//\ Free\ linear\ memory}}
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00122}00122\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00123}00123\ \ \ \ \ reset();\ \ \textcolor{comment}{//\ Reset\ all\ member\ variables}}
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00124}00124\ \}}
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00125}00125\ }
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00126}00126\ \textcolor{comment}{//\ ==========\ MOVE\ SEMANTICS\ ==========}}
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00127}00127\ }
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00135}00135\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ T>}
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00136}\mbox{\hyperlink{classCudaArray3D_a15d3a7ac95491af6db43cf92e1f90454}{00136}}\ \mbox{\hyperlink{classCudaArray3D_a18cedf92dc03e3490ad45dbf09b18c30}{CudaArray3D<T>::CudaArray3D}}(\mbox{\hyperlink{classCudaArray3D}{CudaArray3D}}\&\&\ \mbox{\hyperlink{imag3d-cuda_8cu_abd2b66af1c3a4c07f9d40003c17aceb2}{other}})\ \mbox{\hyperlink{imag3d-cuda_8cu_abd2b66af1c3a4c07f9d40003c17aceb2}{noexcept}}\ }
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00137}00137\ \ \ \ \ :\ pitched\_ptr(\mbox{\hyperlink{imag3d-cuda_8cu_abd2b66af1c3a4c07f9d40003c17aceb2}{other}}.pitched\_ptr),\ }
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00138}00138\ \ \ \ \ \ \ nx(\mbox{\hyperlink{imag3d-cuda_8cu_abd2b66af1c3a4c07f9d40003c17aceb2}{other}}.nx),\ ny(\mbox{\hyperlink{imag3d-cuda_8cu_abd2b66af1c3a4c07f9d40003c17aceb2}{other}}.ny),\ nz(\mbox{\hyperlink{imag3d-cuda_8cu_abd2b66af1c3a4c07f9d40003c17aceb2}{other}}.nz),}
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00139}00139\ \ \ \ \ \ \ total\_elements(\mbox{\hyperlink{imag3d-cuda_8cu_abd2b66af1c3a4c07f9d40003c17aceb2}{other}}.total\_elements),}
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00140}00140\ \ \ \ \ \ \ pitch(\mbox{\hyperlink{imag3d-cuda_8cu_abd2b66af1c3a4c07f9d40003c17aceb2}{other}}.pitch),}
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00141}00141\ \ \ \ \ \ \ use\_pitched(\mbox{\hyperlink{imag3d-cuda_8cu_abd2b66af1c3a4c07f9d40003c17aceb2}{other}}.use\_pitched),}
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00142}00142\ \ \ \ \ \ \ d\_data\_linear(\mbox{\hyperlink{imag3d-cuda_8cu_abd2b66af1c3a4c07f9d40003c17aceb2}{other}}.d\_data\_linear)\ \{}
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00143}00143\ \ \ \ \ \mbox{\hyperlink{imag3d-cuda_8cu_abd2b66af1c3a4c07f9d40003c17aceb2}{other}}.reset();\ \ \textcolor{comment}{//\ Leave\ source\ object\ in\ valid\ but\ empty\ state}}
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00144}00144\ \}}
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00145}00145\ }
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00152}00152\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ T>}
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00153}\mbox{\hyperlink{classCudaArray3D_a3a12f7836a8e958d95c3338de7587a82}{00153}}\ \mbox{\hyperlink{classCudaArray3D}{CudaArray3D<T>}}\&\ \mbox{\hyperlink{classCudaArray3D_a69058486c3d1592e01a8461cfa1a6506}{CudaArray3D<T>::operator=}}(\mbox{\hyperlink{classCudaArray3D}{CudaArray3D}}\&\&\ \mbox{\hyperlink{imag3d-cuda_8cu_abd2b66af1c3a4c07f9d40003c17aceb2}{other}})\ \textcolor{keyword}{noexcept}\ \{}
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00154}00154\ \ \ \ \ \textcolor{keywordflow}{if}\ (\textcolor{keyword}{this}\ !=\ \&\mbox{\hyperlink{imag3d-cuda_8cu_abd2b66af1c3a4c07f9d40003c17aceb2}{other}})\ \{\ \ \textcolor{comment}{//\ Prevent\ self-\/assignment}}
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00155}00155\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Free\ existing\ resources\ before\ taking\ ownership\ of\ new\ ones}}
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00156}00156\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (use\_pitched\ \&\&\ pitched\_ptr.ptr\ !=\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00157}00157\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{imag3d-cuda_8cu_abd2b66af1c3a4c07f9d40003c17aceb2}{cudaFree}}(pitched\_ptr.ptr);}
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00158}00158\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (d\_data\_linear\ !=\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00159}00159\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{imag3d-cuda_8cu_abd2b66af1c3a4c07f9d40003c17aceb2}{cudaFree}}(d\_data\_linear);}
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00160}00160\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00161}00161\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00162}00162\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Transfer\ ownership\ of\ resources\ from\ source\ object}}
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00163}00163\ \ \ \ \ \ \ \ \ pitched\_ptr\ =\ \mbox{\hyperlink{imag3d-cuda_8cu_abd2b66af1c3a4c07f9d40003c17aceb2}{other}}.pitched\_ptr;}
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00164}00164\ \ \ \ \ \ \ \ \ nx\ =\ \mbox{\hyperlink{imag3d-cuda_8cu_abd2b66af1c3a4c07f9d40003c17aceb2}{other}}.nx;}
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00165}00165\ \ \ \ \ \ \ \ \ ny\ =\ \mbox{\hyperlink{imag3d-cuda_8cu_abd2b66af1c3a4c07f9d40003c17aceb2}{other}}.ny;}
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00166}00166\ \ \ \ \ \ \ \ \ nz\ =\ \mbox{\hyperlink{imag3d-cuda_8cu_abd2b66af1c3a4c07f9d40003c17aceb2}{other}}.nz;}
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00167}00167\ \ \ \ \ \ \ \ \ total\_elements\ =\ \mbox{\hyperlink{imag3d-cuda_8cu_abd2b66af1c3a4c07f9d40003c17aceb2}{other}}.total\_elements;}
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00168}00168\ \ \ \ \ \ \ \ \ pitch\ =\ \mbox{\hyperlink{imag3d-cuda_8cu_abd2b66af1c3a4c07f9d40003c17aceb2}{other}}.pitch;}
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00169}00169\ \ \ \ \ \ \ \ \ use\_pitched\ =\ \mbox{\hyperlink{imag3d-cuda_8cu_abd2b66af1c3a4c07f9d40003c17aceb2}{other}}.use\_pitched;}
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00170}00170\ \ \ \ \ \ \ \ \ d\_data\_linear\ =\ \mbox{\hyperlink{imag3d-cuda_8cu_abd2b66af1c3a4c07f9d40003c17aceb2}{other}}.d\_data\_linear;}
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00171}00171\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00172}00172\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Leave\ source\ object\ in\ valid\ but\ empty\ state}}
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00173}00173\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{imag3d-cuda_8cu_abd2b66af1c3a4c07f9d40003c17aceb2}{other}}.reset();}
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00174}00174\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00175}00175\ \ \ \ \ \textcolor{keywordflow}{return}\ *\textcolor{keyword}{this};}
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00176}00176\ \}}
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00177}00177\ }
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00178}00178\ \textcolor{comment}{//\ ==========\ DATA\ TRANSFER\ OPERATIONS\ ==========}}
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00179}00179\ }
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00187}00187\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ T>}
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00188}\mbox{\hyperlink{classCudaArray3D_a0de2de973029734741dddb20b136b248}{00188}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classCudaArray3D_a0de2de973029734741dddb20b136b248}{CudaArray3D<T>::copyFromHost}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{imag3d-cuda_8cu_abd2b66af1c3a4c07f9d40003c17aceb2}{T}}*\ \mbox{\hyperlink{imag3d-cuda_8cu_abd2b66af1c3a4c07f9d40003c17aceb2}{h\_data}})\ \{}
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00189}00189\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{imag3d-cuda_8cu_abd2b66af1c3a4c07f9d40003c17aceb2}{h\_data}}\ ==\ \textcolor{keyword}{nullptr}\ ||\ total\_elements\ ==\ 0)\ \textcolor{keywordflow}{return};\ \ \textcolor{comment}{//\ Safety\ checks}}
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00190}00190\ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00191}00191\ \ \ \ \ \textcolor{keywordflow}{if}\ (use\_pitched)\ \{}
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00192}00192\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ =====\ PITCHED\ MEMORY\ COPY\ =====}}
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00193}00193\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Use\ cudaMemcpy3D\ to\ handle\ padding\ and\ memory\ layout\ automatically}}
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00194}00194\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{imag3d-cuda_8cu_abd2b66af1c3a4c07f9d40003c17aceb2}{cudaMemcpy3DParms}}\ \mbox{\hyperlink{imag3d-cuda_8cu_abd2b66af1c3a4c07f9d40003c17aceb2}{params}}\ =\ \{0\};\ \ \textcolor{comment}{//\ Initialize\ all\ fields\ to\ zero}}
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00195}00195\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00196}00196\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Configure\ source\ (host)\ -\/\ treat\ as\ linear\ memory}}
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00197}00197\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{imag3d-cuda_8cu_abd2b66af1c3a4c07f9d40003c17aceb2}{params}}.srcPtr\ =\ \mbox{\hyperlink{imag3d-cuda_8cu_abd2b66af1c3a4c07f9d40003c17aceb2}{make\_cudaPitchedPtr}}((\textcolor{keywordtype}{void}*)\mbox{\hyperlink{imag3d-cuda_8cu_abd2b66af1c3a4c07f9d40003c17aceb2}{h\_data}},\ }
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00198}00198\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ nx\ *\ \textcolor{keyword}{sizeof}(\mbox{\hyperlink{imag3d-cuda_8cu_abd2b66af1c3a4c07f9d40003c17aceb2}{T}}),\ \ \textcolor{comment}{//\ pitch\ =\ width\ (no\ padding)}}
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00199}00199\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ nx\ *\ \textcolor{keyword}{sizeof}(\mbox{\hyperlink{imag3d-cuda_8cu_abd2b66af1c3a4c07f9d40003c17aceb2}{T}}),\ \ \textcolor{comment}{//\ width\ in\ bytes}}
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00200}00200\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ny);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ height}}
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00201}00201\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{imag3d-cuda_8cu_abd2b66af1c3a4c07f9d40003c17aceb2}{params}}.srcPos\ =\ \mbox{\hyperlink{imag3d-cuda_8cu_abd2b66af1c3a4c07f9d40003c17aceb2}{make\_cudaPos}}(0,\ 0,\ 0);\ \ \textcolor{comment}{//\ Start\ from\ origin}}
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00202}00202\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00203}00203\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Configure\ destination\ (device)\ -\/\ use\ pitched\ memory\ layout}}
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00204}00204\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{imag3d-cuda_8cu_abd2b66af1c3a4c07f9d40003c17aceb2}{params}}.dstPtr\ =\ pitched\_ptr;\ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Our\ pitched\ memory\ allocation}}
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00205}00205\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{imag3d-cuda_8cu_abd2b66af1c3a4c07f9d40003c17aceb2}{params}}.dstPos\ =\ \mbox{\hyperlink{imag3d-cuda_8cu_abd2b66af1c3a4c07f9d40003c17aceb2}{make\_cudaPos}}(0,\ 0,\ 0);\ \ \textcolor{comment}{//\ Start\ from\ origin}}
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00206}00206\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00207}00207\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Configure\ copy\ extent\ and\ direction}}
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00208}00208\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{imag3d-cuda_8cu_abd2b66af1c3a4c07f9d40003c17aceb2}{params}}.extent\ =\ \mbox{\hyperlink{imag3d-cuda_8cu_abd2b66af1c3a4c07f9d40003c17aceb2}{make\_cudaExtent}}(nx\ *\ \textcolor{keyword}{sizeof}(\mbox{\hyperlink{imag3d-cuda_8cu_abd2b66af1c3a4c07f9d40003c17aceb2}{T}}),\ ny,\ nz);\ \ \textcolor{comment}{//\ Full\ array\ size}}
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00209}00209\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{imag3d-cuda_8cu_abd2b66af1c3a4c07f9d40003c17aceb2}{params}}.kind\ =\ \mbox{\hyperlink{imag3d-cuda_8cu_abd2b66af1c3a4c07f9d40003c17aceb2}{cudaMemcpyHostToDevice}};}
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00210}00210\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00211}00211\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Execute\ the\ 3D\ copy\ operation}}
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00212}00212\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{imag3d-cuda_8cu_abd2b66af1c3a4c07f9d40003c17aceb2}{cudaError\_t}}\ \mbox{\hyperlink{imag3d-cuda_8cu_abd2b66af1c3a4c07f9d40003c17aceb2}{error}}\ =\ \mbox{\hyperlink{imag3d-cuda_8cu_abd2b66af1c3a4c07f9d40003c17aceb2}{cudaMemcpy3D}}(\&\mbox{\hyperlink{imag3d-cuda_8cu_abd2b66af1c3a4c07f9d40003c17aceb2}{params}});}
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00213}00213\ \ \ \ \ \ \ \ \ checkCudaError(\mbox{\hyperlink{imag3d-cuda_8cu_abd2b66af1c3a4c07f9d40003c17aceb2}{error}},\ \textcolor{stringliteral}{"{}Failed\ to\ copy\ data\ from\ host\ to\ device\ (pitched)"{}});}
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00214}00214\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00215}00215\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ =====\ LINEAR\ MEMORY\ COPY\ =====}}
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00216}00216\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Simple\ contiguous\ memory\ copy\ -\/\ no\ padding\ to\ worry\ about}}
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00217}00217\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{imag3d-cuda_8cu_abd2b66af1c3a4c07f9d40003c17aceb2}{bytes}}\ =\ total\_elements\ *\ \textcolor{keyword}{sizeof}(\mbox{\hyperlink{imag3d-cuda_8cu_abd2b66af1c3a4c07f9d40003c17aceb2}{T}});}
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00218}00218\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{imag3d-cuda_8cu_abd2b66af1c3a4c07f9d40003c17aceb2}{cudaError\_t}}\ \mbox{\hyperlink{imag3d-cuda_8cu_abd2b66af1c3a4c07f9d40003c17aceb2}{error}}\ =\ \mbox{\hyperlink{imag3d-cuda_8cu_abd2b66af1c3a4c07f9d40003c17aceb2}{cudaMemcpy}}(d\_data\_linear,\ \mbox{\hyperlink{imag3d-cuda_8cu_abd2b66af1c3a4c07f9d40003c17aceb2}{h\_data}},\ \mbox{\hyperlink{imag3d-cuda_8cu_abd2b66af1c3a4c07f9d40003c17aceb2}{bytes}},\ \mbox{\hyperlink{imag3d-cuda_8cu_abd2b66af1c3a4c07f9d40003c17aceb2}{cudaMemcpyHostToDevice}});}
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00219}00219\ \ \ \ \ \ \ \ \ checkCudaError(\mbox{\hyperlink{imag3d-cuda_8cu_abd2b66af1c3a4c07f9d40003c17aceb2}{error}},\ \textcolor{stringliteral}{"{}Failed\ to\ copy\ data\ from\ host\ to\ device"{}});}
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00220}00220\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00221}00221\ \}}
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00222}00222\ }
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00229}00229\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ T>}
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00230}\mbox{\hyperlink{classCudaArray3D_ac63bdebb19176daacdb9d719af2adc1b}{00230}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classCudaArray3D_ac63bdebb19176daacdb9d719af2adc1b}{CudaArray3D<T>::copyToHost}}(\mbox{\hyperlink{imag3d-cuda_8cu_abd2b66af1c3a4c07f9d40003c17aceb2}{T}}*\ \mbox{\hyperlink{imag3d-cuda_8cu_abd2b66af1c3a4c07f9d40003c17aceb2}{h\_data}})\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00231}00231\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{imag3d-cuda_8cu_abd2b66af1c3a4c07f9d40003c17aceb2}{h\_data}}\ ==\ \textcolor{keyword}{nullptr}\ ||\ total\_elements\ ==\ 0)\ \textcolor{keywordflow}{return};\ \ \textcolor{comment}{//\ Safety\ checks}}
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00232}00232\ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00233}00233\ \ \ \ \ \textcolor{keywordflow}{if}\ (use\_pitched)\ \{}
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00234}00234\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ =====\ PITCHED\ MEMORY\ COPY\ =====}}
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00235}00235\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Use\ cudaMemcpy3D\ to\ properly\ handle\ padding\ removal}}
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00236}00236\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{imag3d-cuda_8cu_abd2b66af1c3a4c07f9d40003c17aceb2}{cudaMemcpy3DParms}}\ \mbox{\hyperlink{imag3d-cuda_8cu_abd2b66af1c3a4c07f9d40003c17aceb2}{params}}\ =\ \{0\};\ \ \textcolor{comment}{//\ Initialize\ all\ fields\ to\ zero}}
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00237}00237\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00238}00238\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Configure\ source\ (device)\ -\/\ use\ pitched\ memory\ layout}}
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00239}00239\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{imag3d-cuda_8cu_abd2b66af1c3a4c07f9d40003c17aceb2}{params}}.srcPtr\ =\ pitched\_ptr;\ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Our\ pitched\ memory\ allocation}}
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00240}00240\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{imag3d-cuda_8cu_abd2b66af1c3a4c07f9d40003c17aceb2}{params}}.srcPos\ =\ \mbox{\hyperlink{imag3d-cuda_8cu_abd2b66af1c3a4c07f9d40003c17aceb2}{make\_cudaPos}}(0,\ 0,\ 0);\ \ \textcolor{comment}{//\ Start\ from\ origin}}
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00241}00241\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00242}00242\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Configure\ destination\ (host)\ -\/\ treat\ as\ linear\ memory}}
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00243}00243\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{imag3d-cuda_8cu_abd2b66af1c3a4c07f9d40003c17aceb2}{params}}.dstPtr\ =\ \mbox{\hyperlink{imag3d-cuda_8cu_abd2b66af1c3a4c07f9d40003c17aceb2}{make\_cudaPitchedPtr}}((\textcolor{keywordtype}{void}*)\mbox{\hyperlink{imag3d-cuda_8cu_abd2b66af1c3a4c07f9d40003c17aceb2}{h\_data}},}
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00244}00244\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ nx\ *\ \textcolor{keyword}{sizeof}(\mbox{\hyperlink{imag3d-cuda_8cu_abd2b66af1c3a4c07f9d40003c17aceb2}{T}}),\ \ \textcolor{comment}{//\ pitch\ =\ width\ (no\ padding)}}
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00245}00245\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ nx\ *\ \textcolor{keyword}{sizeof}(\mbox{\hyperlink{imag3d-cuda_8cu_abd2b66af1c3a4c07f9d40003c17aceb2}{T}}),\ \ \textcolor{comment}{//\ width\ in\ bytes}}
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00246}00246\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ny);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ height}}
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00247}00247\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{imag3d-cuda_8cu_abd2b66af1c3a4c07f9d40003c17aceb2}{params}}.dstPos\ =\ \mbox{\hyperlink{imag3d-cuda_8cu_abd2b66af1c3a4c07f9d40003c17aceb2}{make\_cudaPos}}(0,\ 0,\ 0);\ \ \textcolor{comment}{//\ Start\ from\ origin}}
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00248}00248\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00249}00249\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Configure\ copy\ extent\ and\ direction}}
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00250}00250\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{imag3d-cuda_8cu_abd2b66af1c3a4c07f9d40003c17aceb2}{params}}.extent\ =\ \mbox{\hyperlink{imag3d-cuda_8cu_abd2b66af1c3a4c07f9d40003c17aceb2}{make\_cudaExtent}}(nx\ *\ \textcolor{keyword}{sizeof}(\mbox{\hyperlink{imag3d-cuda_8cu_abd2b66af1c3a4c07f9d40003c17aceb2}{T}}),\ ny,\ nz);\ \ \textcolor{comment}{//\ Full\ array\ size}}
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00251}00251\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{imag3d-cuda_8cu_abd2b66af1c3a4c07f9d40003c17aceb2}{params}}.kind\ =\ \mbox{\hyperlink{imag3d-cuda_8cu_abd2b66af1c3a4c07f9d40003c17aceb2}{cudaMemcpyDeviceToHost}};}
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00252}00252\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00253}00253\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Execute\ the\ 3D\ copy\ operation\ (removes\ padding\ automatically)}}
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00254}00254\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{imag3d-cuda_8cu_abd2b66af1c3a4c07f9d40003c17aceb2}{cudaError\_t}}\ \mbox{\hyperlink{imag3d-cuda_8cu_abd2b66af1c3a4c07f9d40003c17aceb2}{error}}\ =\ \mbox{\hyperlink{imag3d-cuda_8cu_abd2b66af1c3a4c07f9d40003c17aceb2}{cudaMemcpy3D}}(\&\mbox{\hyperlink{imag3d-cuda_8cu_abd2b66af1c3a4c07f9d40003c17aceb2}{params}});}
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00255}00255\ \ \ \ \ \ \ \ \ checkCudaError(\mbox{\hyperlink{imag3d-cuda_8cu_abd2b66af1c3a4c07f9d40003c17aceb2}{error}},\ \textcolor{stringliteral}{"{}Failed\ to\ copy\ data\ from\ device\ to\ host\ (pitched)"{}});}
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00256}00256\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00257}00257\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ =====\ LINEAR\ MEMORY\ COPY\ =====}}
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00258}00258\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Simple\ contiguous\ memory\ copy\ -\/\ no\ padding\ to\ remove}}
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00259}00259\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{imag3d-cuda_8cu_abd2b66af1c3a4c07f9d40003c17aceb2}{bytes}}\ =\ total\_elements\ *\ \textcolor{keyword}{sizeof}(\mbox{\hyperlink{imag3d-cuda_8cu_abd2b66af1c3a4c07f9d40003c17aceb2}{T}});}
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00260}00260\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{imag3d-cuda_8cu_abd2b66af1c3a4c07f9d40003c17aceb2}{cudaError\_t}}\ \mbox{\hyperlink{imag3d-cuda_8cu_abd2b66af1c3a4c07f9d40003c17aceb2}{error}}\ =\ \mbox{\hyperlink{imag3d-cuda_8cu_abd2b66af1c3a4c07f9d40003c17aceb2}{cudaMemcpy}}(\mbox{\hyperlink{imag3d-cuda_8cu_abd2b66af1c3a4c07f9d40003c17aceb2}{h\_data}},\ d\_data\_linear,\ \mbox{\hyperlink{imag3d-cuda_8cu_abd2b66af1c3a4c07f9d40003c17aceb2}{bytes}},\ \mbox{\hyperlink{imag3d-cuda_8cu_abd2b66af1c3a4c07f9d40003c17aceb2}{cudaMemcpyDeviceToHost}});}
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00261}00261\ \ \ \ \ \ \ \ \ checkCudaError(\mbox{\hyperlink{imag3d-cuda_8cu_abd2b66af1c3a4c07f9d40003c17aceb2}{error}},\ \textcolor{stringliteral}{"{}Failed\ to\ copy\ data\ from\ device\ to\ host"{}});}
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00262}00262\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00263}00263\ \}}
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00264}00264\ }
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00265}00265\ }
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00271}00271\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ T>}
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00272}\mbox{\hyperlink{classCudaArray3D_afdeb0db2f7018394c01684b2a1f0bbe5}{00272}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classCudaArray3D_afdeb0db2f7018394c01684b2a1f0bbe5}{CudaArray3D<T>::checkCudaError}}(\mbox{\hyperlink{imag3d-cuda_8cu_abd2b66af1c3a4c07f9d40003c17aceb2}{cudaError\_t}}\ \mbox{\hyperlink{imag3d-cuda_8cu_abd2b66af1c3a4c07f9d40003c17aceb2}{error}},\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ \mbox{\hyperlink{imag3d-cuda_8cu_abd2b66af1c3a4c07f9d40003c17aceb2}{msg}})\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00273}00273\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{imag3d-cuda_8cu_abd2b66af1c3a4c07f9d40003c17aceb2}{error}}\ !=\ \mbox{\hyperlink{imag3d-cuda_8cu_abd2b66af1c3a4c07f9d40003c17aceb2}{cudaSuccess}})\ \{}
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00274}00274\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Combine\ user\ message\ with\ CUDA\ error\ description\ for\ better\ debugging}}
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00275}00275\ \ \ \ \ \ \ \ \ std::string\ \mbox{\hyperlink{imag3d-cuda_8cu_abd2b66af1c3a4c07f9d40003c17aceb2}{errorMsg}}\ =\ std::string(\mbox{\hyperlink{imag3d-cuda_8cu_abd2b66af1c3a4c07f9d40003c17aceb2}{msg}})\ +\ \textcolor{stringliteral}{"{}:\ "{}}\ +\ \mbox{\hyperlink{imag3d-cuda_8cu_abd2b66af1c3a4c07f9d40003c17aceb2}{cudaGetErrorString}}(\mbox{\hyperlink{imag3d-cuda_8cu_abd2b66af1c3a4c07f9d40003c17aceb2}{error}});}
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00276}00276\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ std::runtime\_error(\mbox{\hyperlink{imag3d-cuda_8cu_abd2b66af1c3a4c07f9d40003c17aceb2}{errorMsg}});}
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00277}00277\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00278}00278\ \}}
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00279}00279\ }
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00280}00280\ \textcolor{comment}{//\ ==========\ EXPLICIT\ TEMPLATE\ INSTANTIATIONS\ ==========}}
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00281}00281\ \textcolor{comment}{//\ These\ ensure\ the\ template\ is\ compiled\ for\ specific\ types\ used\ in\ the\ project}}
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00282}00282\ }
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00283}00283\ \textcolor{comment}{//\ Include\ CUDA\ complex\ types\ for\ instantiation}}
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00284}00284\ \textcolor{preprocessor}{\#include\ <cuComplex.h>}}
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00285}00285\ \textcolor{preprocessor}{\#include\ <cufft.h>}}
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00286}00286\ }
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00287}00287\ \textcolor{comment}{//\ Real\ number\ types}}
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00288}00288\ \textcolor{keyword}{template}\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classCudaArray3D}{CudaArray3D<double>}};}
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00289}00289\ \textcolor{keyword}{template}\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classCudaArray3D}{CudaArray3D<float>}};}
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00290}00290\ }
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00291}00291\ \textcolor{comment}{//\ Complex\ number\ types\ for\ CUDA/cuFFT}}
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00292}00292\ \textcolor{keyword}{template}\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classCudaArray3D}{CudaArray3D<cuDoubleComplex>}};}
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00293}00293\ \textcolor{keyword}{template}\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classCudaArray3D}{CudaArray3D<cuFloatComplex>}};}
\DoxyCodeLine{\Hypertarget{CudaArray_8cpp_source_l00294}00294\ }

\end{DoxyCode}
